<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Itinerarios de Viaje</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        header {
            background-color:  #FC9D64;
            ;
            color: white;
            text-align: center;
            padding: 1rem;
        }
        .container {
            margin: 2rem auto;
            max-width: 800px;
            padding: 1rem;
        }
        form {
            margin-bottom: 2rem;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 0.75rem;
            text-align: left;
        }
        .btn {
            cursor: pointer;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
        }
        .btn-add {
            background-color: #28a745;
            color: white;
        }
        .btn-edit {
            background-color: #ffc107;
            color: white;
        }
        .btn-delete {
            background-color: #dc3545;
            color: white;
        }
    </style>
</head>
<body>
    <header>
        <h1>Gestión de Itinerarios de Viaje</h1>
    </header>
    <div class="container">
        <h2>Crear Itinerario</h2>
        <form id="itineraryForm">
            <label for="destination">Destino:</label>
            <input type="text" id="destination" name="destination" required>
            <label for="date">Fecha:</label>
            <input type="date" id="date" name="date" required>
            <button type="submit" class="btn btn-add">Agregar</button>
        </form>

        <h2>Itinerarios</h2>
        <table id="itineraryTable">
            <thead>
                <tr>
                    <th>Destino</th>
                    <th>Fecha</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <!-- Las filas se agregarán dinámicamente aquí -->
            </tbody>
        </table>
    </div>

    <script>
        const itineraryForm = document.getElementById('itineraryForm');
        const itineraryTable = document.getElementById('itineraryTable').querySelector('tbody');
        const dateInput = document.getElementById('date');

        // Establecer fecha mínima en cualquier campo de fecha
        function setMinDate(input) {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            input.min = `${year}-${month}-${day}`;
        }

        // Llamar a setMinDate en el campo inicial al cargar la página
        document.addEventListener('DOMContentLoaded', () => setMinDate(dateInput));

        itineraryForm.addEventListener('submit', function(event) {
            event.preventDefault();

            const destination = document.getElementById('destination').value;
            const date = document.getElementById('date').value;

            const row = document.createElement('tr');

            row.innerHTML = `
                <td>${destination}</td>
                <td>${date}</td>
                <td>
                    <button class="btn btn-edit" onclick="editRow(this)">Editar</button>
                    <button class="btn btn-delete" onclick="deleteRow(this)">Eliminar</button>
                </td>
            `;

            itineraryTable.appendChild(row);

            itineraryForm.reset();
            setMinDate(dateInput); // Restablecer la fecha mínima para el próximo uso
        });

        function editRow(button) {
            const row = button.parentNode.parentNode;
            const destinationCell = row.children[0];
            const dateCell = row.children[1];

            const currentDestination = destinationCell.textContent;
            const currentDate = dateCell.textContent;

            // Crear inputs para editar
            destinationCell.innerHTML = `<input type="text" value="${currentDestination}" required>`;
            dateCell.innerHTML = `<input type="date" value="${currentDate}" required>`;

            const dateInput = dateCell.querySelector('input[type="date"]');
            setMinDate(dateInput); // Establecer fecha mínima en el nuevo campo de fecha

            // Cambiar botón "Editar" a "Guardar"
            button.textContent = 'Guardar';
            button.classList.remove('btn-edit');
            button.classList.add('btn-add');

            button.onclick = function () {
                const newDestination = destinationCell.querySelector('input').value;
                const newDate = dateCell.querySelector('input').value;

                if (newDestination && newDate) {
                    destinationCell.textContent = newDestination;
                    dateCell.textContent = newDate;

                    button.textContent = 'Editar';
                    button.classList.remove('btn-add');
                    button.classList.add('btn-edit');
                    button.onclick = function () {
                        editRow(button);
                    };
                }
            };
        }

        function deleteRow(button) {
            const row = button.parentNode.parentNode;
            itineraryTable.removeChild(row);
        }
    </script>
    <script src="src/routes/itinerarios.js"></script>
</body>
</html>
